define("./active_x",["./component"],function(d){var d=d("./component"),h=function(b,c){for(var a in b)typeof b[a]=="function"&&a!="handleException"&&(b[a]=_.wrap(b[a],function(a){try{return a.apply(b,Array.prototype.slice.call(arguments,1))}catch(g){return c.call(b,g)}}))},f=d.extend({el:null,ocxEl:null,constructor:function(b,c,a){var e=b.el.attr("id");if(e)this.no=function(){return"ocx_"+e};c==null?c=["hikui-active"]:c.push("hikui-active");h(this,function(a){if(this.handleException)return this.handleException(a);
a=this.msgEl||this.el;this.ocxEl!=null&&this.ocxEl.hide();a.find('div[msgType="msg"]').remove();a.find("*").hide();var b=['<div class="msg-b msg-b-stop"><i></i><div class="msg-cnt">'];b.push("<span>"+language.text("ocx.error")+"</span>");if(this.getOcxUrl!=null){var c=null;if(typeof this.getOcxUrl=="function")c=this.getOcxUrl();else if(typeof this.getOcxUrl=="string")c=this.getOcxUrl;this.id.indexOf("swf_schedule")>-1?(b.push("<p>"),b.push(language.text("flash.error")),b.push("</p>")):c!=null&&(b.push("<p>"),
b.push(language.text("ocx.load")),b.push("</p>"))}b.push("</div></div>");a.append(b.join(""));return!1});this.base(b,c,a)},render:function(b,c){if(loader)loader.change=function(a){a.readyState==4&&loader&&(loader.hide(),delete loader.change)};this.ocxEl=$.browser.msie?this.el.find("object"):this.el.find("embed");if(!this.ocxEl.length){var a=['<object classid="',b,'" width="100%" onreadystatechange="loader.change(this)" height="100%" id="',this.no(),'" name="',this.no(),'"'];this.codebase&&a.push(['CODEBASE="',
c||"","/web/softs/HIKOCX.CAB#version=",this.codebase,'"'].join(""));a.push(" >");this.params&&$.each(this.params,function(b,c){a.push('<param name="');a.push(b);a.push('" value="');a.push(c);a.push('">')});var e=this.no().split("_"),d=e.length;a.push(['<embed type="'+b+'" width="100%" height="100%" onreadystatechange="loader.change(this)" id="embed_'+this.no()+'" name="'+this.no()+'"windowid="'+e[d-1]+'"']);a.push(">");a.push("</object>");this.el.html(a.join(""));this.ocxEl=$.browser.msie?this.el.find("object"):
this.el.find("embed")}},throwError:function(b){throw Error(b);},destroy:function(){this.ocxEl!=null&&(this.ocxEl.hide(),this.ocxEl.remove());this.base()}});f.BASE_URL=d.BASE_URL;return f});
